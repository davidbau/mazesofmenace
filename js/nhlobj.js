// Autogenerated translator module for currently-unmapped C source outputs.
// Contents are syntax-validated emitted functions; wiring into runtime is separate.

// Autotranslated from nhlobj.c:34
export function l_obj_check(L, indx) {
  let lo;
  luaL_checktype(L, indx, LUA_TUSERDATA);
  lo =  luaL_checkudata(L, indx, "obj");
  if (!lo) nhl_error(L, "Obj error");
  return lo;
}

// Autotranslated from nhlobj.c:46
export function l_obj_gc(L) {
  let obj, otmp, lo = l_obj_check(L, 1);
  if (lo && (obj = lo.obj) !== 0) {
    if (obj.lua_ref_cnt > 0) obj.lua_ref_cnt--;
    if (!obj.lua_ref_cnt && (obj.where === OBJ_FREE || obj.where === OBJ_LUAFREE)) {
      if (Has_contents(obj)) {
        while ((otmp = obj.cobj) !== 0) {
          obj_extract_self(otmp);
          dealloc_obj(otmp);
        }
      }
      obj.where = OBJ_FREE;
      dealloc_obj(obj), obj = 0;
    }
    lo.obj = null;
  }
  return 0;
}

// Autotranslated from nhlobj.c:72
export function l_obj_push(L, otmp) {
  let lo =  lua_newuserdata(L, sizeof );
  luaL_getmetatable(L, "obj");
  lua_setmetatable(L, -2);
  lo.state = 0;
  lo.obj = otmp;
  if (otmp) otmp.lua_ref_cnt++;
  return lo;
}

// Autotranslated from nhlobj.c:88
export function nhl_push_obj(L, otmp) {
  l_obj_push(L, otmp);
}

// Autotranslated from nhlobj.c:96
export function l_obj_getcontents(L) {
  let lo = l_obj_check(L, 1), obj = lo.obj;
  if (!obj) nhl_error(L, "l_obj_getcontents: no obj");
  l_obj_push(L, obj.cobj);
  return 1;
}

// Autotranslated from nhlobj.c:113
export function l_obj_add_to_container(L) {
  let lobox = l_obj_check(L, 1), lo = l_obj_check(L, 2), otmp, refs;
  if (!lobj_is_ok(lo) || !lobj_is_ok(lobox)) return 0;
  refs = lo.obj.lua_ref_cnt;
  obj_extract_self(lo.obj);
  otmp = add_to_container(lobox.obj, lo.obj);
  if (otmp !== lo.obj) { lo.obj = otmp; lo.obj.lua_ref_cnt += refs; }
  lobox.obj.owt = weight(lobox.obj);
  return 0;
}

// Autotranslated from nhlobj.c:141
export function nhl_obj_u_giveobj(L) {
  let lo = l_obj_check(L, 1), otmp, refs;
  if (!lobj_is_ok(lo) || lo.obj.where === OBJ_INVENT) return 0;
  refs = lo.obj.lua_ref_cnt;
  obj_extract_self(lo.obj);
  otmp = addinv(lo.obj);
  if (otmp !== lo.obj) { lo.obj.lua_ref_cnt += refs; lo.obj = otmp; }
  return 0;
}

// Autotranslated from nhlobj.c:246
export function l_obj_to_table(L) {
  let lo = l_obj_check(L, 1), obj = lo.obj;
  lua_newtable(L);
  if (!obj || obj.where === OBJ_LUAFREE) { nhl_add_table_entry_int(L, "NO_OBJ", 1); return 1; }
  nhl_add_table_entry_int(L, "has_contents", Has_contents(obj));
  nhl_add_table_entry_int(L, "is_container", Is_container(obj));
  nhl_add_table_entry_int(L, "o_id", obj.o_id);
  nhl_add_table_entry_int(L, "ox", obj.ox);
  nhl_add_table_entry_int(L, "oy", obj.oy);
  nhl_add_table_entry_int(L, "otyp", obj.otyp);
  if (OBJ_NAME(objects[obj.otyp])) nhl_add_table_entry_str(L, "otyp_name", OBJ_NAME(objects[obj.otyp]));
  if (OBJ_DESCR(objects[obj.otyp])) nhl_add_table_entry_str(L, "otyp_descr", OBJ_DESCR(objects[obj.otyp]));
  nhl_add_table_entry_int(L, "owt", obj.owt);
  nhl_add_table_entry_int(L, "quan", obj.quan);
  nhl_add_table_entry_int(L, "spe", obj.spe);
  if (obj.otyp === STATUE) nhl_add_table_entry_int(L, "historic", (obj.spe & CORPSTAT_HISTORIC) !== 0);
  if (obj.otyp === CORPSE || obj.otyp === STATUE) {
    nhl_add_table_entry_int(L, "male", (obj.spe & CORPSTAT_MALE) !== 0);
    nhl_add_table_entry_int(L, "female", (obj.spe & CORPSTAT_FEMALE) !== 0);
  }
  nhl_add_table_entry_char(L, "oclass", def_oc_syms[ obj.oclass].sym);
  nhl_add_table_entry_char(L, "invlet", obj.invlet);
  nhl_add_table_entry_int(L, "where", obj.where);
  nhl_add_table_entry_int(L, "cursed", obj.cursed);
  nhl_add_table_entry_int(L, "blessed", obj.blessed);
  nhl_add_table_entry_int(L, "unpaid", obj.unpaid);
  nhl_add_table_entry_int(L, "no_charge", obj.no_charge);
  nhl_add_table_entry_int(L, "known", obj.known);
  nhl_add_table_entry_int(L, "dknown", obj.dknown);
  nhl_add_table_entry_int(L, "bknown", obj.bknown);
  nhl_add_table_entry_int(L, "rknown", obj.rknown);
  nhl_add_table_entry_int(L, "tknown", obj.tknown);
  if (obj.oclass === POTION_CLASS) nhl_add_table_entry_int(L, "odiluted", obj.odiluted);
  else {
    nhl_add_table_entry_int(L, "oeroded", obj.oeroded);
  }
  nhl_add_table_entry_int(L, "oeroded2", obj.oeroded2);
  nhl_add_table_entry_int(L, "oerodeproof", obj.oerodeproof);
  nhl_add_table_entry_int(L, "olocked", obj.olocked);
  nhl_add_table_entry_int(L, "obroken", obj.obroken);
  if (is_poisonable(obj)) nhl_add_table_entry_int(L, "opoisoned", obj.opoisoned);
  else {
    nhl_add_table_entry_int(L, "otrapped", obj.otrapped);
  }
  nhl_add_table_entry_int(L, "recharged", obj.recharged);
  nhl_add_table_entry_int(L, "lamplit", obj.lamplit);
  nhl_add_table_entry_int(L, "globby", obj.globby);
  nhl_add_table_entry_int(L, "greased", obj.greased);
  nhl_add_table_entry_int(L, "nomerge", obj.nomerge);
  nhl_add_table_entry_int(L, "how_lost", obj.how_lost);
  nhl_add_table_entry_int(L, "in_use", obj.in_use);
  nhl_add_table_entry_int(L, "bypass", obj.bypass);
  nhl_add_table_entry_int(L, "cknown", obj.cknown);
  nhl_add_table_entry_int(L, "lknown", obj.lknown);
  nhl_add_table_entry_int(L, "corpsenm", obj.corpsenm);
  if (obj.corpsenm !== NON_PM && (obj.otyp === TIN || obj.otyp === CORPSE || obj.otyp === EGG || obj.otyp === FIGURINE || obj.otyp === STATUE)) nhl_add_table_entry_str(L, "corpsenm_name", mons[obj.corpsenm].pmnames[NEUTRAL]);
  nhl_add_table_entry_int(L, "usecount", obj.usecount);
  nhl_add_table_entry_int(L, "oeaten", obj.oeaten);
  nhl_add_table_entry_int(L, "age", obj.age);
  nhl_add_table_entry_int(L, "owornmask", obj.owornmask);
  nhl_add_table_entry_int(L, "has_oname", has_oname(obj));
  if (has_oname(obj)) nhl_add_table_entry_str(L, "oname", ONAME(obj));
  return 1;
}

// Autotranslated from nhlobj.c:412
export function l_obj_placeobj(L) {
  let argc = lua_gettop(L), lo = l_obj_check(L, 1), x, y;
  if (argc !== 3) nhl_error(L, "l_obj_placeobj: Wrong args");
  x =  luaL_checkinteger(L, 2);
  y =  luaL_checkinteger(L, 3);
  cvt_to_abscoord( x, y);
  lua_pop(L, 3);
  if (lobj_is_ok(lo)) {
    obj_extract_self(lo.obj);
    place_object(lo.obj, x, y);
    newsym(x, y);
  }
  return 0;
}

// Autotranslated from nhlobj.c:444
export function l_obj_nextobj(L) {
  let argc = lua_gettop(L);
  if (argc === 0) { l_obj_push(L, fobj); }
  else {
    let lo = l_obj_check(L, 1), use_nexthere = false;
    if (argc === 2) use_nexthere = lua_toboolean(L, 2);
    if (lo && lo.obj) {
      l_obj_push(L, (use_nexthere && lo.obj.where === OBJ_FLOOR) ? lo.obj.nexthere : lo.obj.nobj);
    }
  }
  return 1;
}

// Autotranslated from nhlobj.c:468
export function l_obj_container(L) {
  let lo = l_obj_check(L, 1);
  if (lo && lo.obj && lo.obj.where === OBJ_CONTAINED) {
    l_obj_push(L, lo.obj.ocontainer);
  }
  else {
    l_obj_push(L, null);
  }
  return 1;
}

// Autotranslated from nhlobj.c:482
export function l_obj_isnull(L) {
  let lo = l_obj_check(L, 1);
  lua_pushboolean(L, !lobj_is_ok(lo));
  return 1;
}
