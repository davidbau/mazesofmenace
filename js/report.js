// Autogenerated translator module for currently-unmapped C source outputs.
// Contents are syntax-validated emitted functions; wiring into runtime is separate.

// TRANSLATOR: AUTO (report.c:188)
export function crashreport_bidshow() {
  raw_print(bid);
}

// TRANSLATOR: AUTO (report.c:528)
export function NH_panictrace_gdb() {
  let gdbpath = GDBVAR, greppath = GREPVAR, buf, gdb;
  if (gdbpath === null || gdbpath[0] === 0) return false;
  if (greppath === null || greppath[0] === 0) return false;
  Snprintf(buf, buf.length, "%s -n -q %s %d 2>&1 | %s '^#'", gdbpath, ARGV0, getpid(), greppath);
  gdb = popen(buf, "w");
  if (gdb) {
    raw_print(" Generating more information you may report:\n");
    fprintf(gdb, "bt\nquit\ny");
    fflush(gdb);
    sleep(4);
    pclose(gdb);
    return true;
  }
  else { return false; }
}

// TRANSLATOR: AUTO (report.c:599)
export function panictrace_handler(sig_unused) {
  let f2;
  f2 =  write(2, SIG_MSG, SIG_MSG.length - 1);
  nhUse(f2);
  NH_abort(null);
}

// TRANSLATOR: AUTO (report.c:624)
export function panictrace_setsignals(set) {
  SETSIGNAL(SIGILL);
  SETSIGNAL(SIGTRAP);
  SETSIGNAL(SIGIOT);
  SETSIGNAL(SIGBUS);
  SETSIGNAL(SIGFPE);
  SETSIGNAL(SIGSEGV);
  SETSIGNAL(SIGSTKFLT);
  SETSIGNAL(SIGSYS);
}

// TRANSLATOR: AUTO (report.c:460)
export function dobugreport() {
  if (!submit_web_report(2, null, "#bugreport command")) {
    pline("Unable to send bug report. Please visit %s instead.", (sysopt.crashreporturl && sysopt.crashreporturl) ? sysopt.crashreporturl : DEVTEAM_URL );
  }
  return ECMD_OK;
}

// TRANSLATOR: AUTO (report.c:484)
export function NH_panictrace_libc() {
  let bt, count, x, info, buf;
  raw_print(" Generating more information you may report:\n");
  count = backtrace(bt, SIZE(bt));
  info = backtrace_symbols(bt, count);
  for (x = 0; x < count; x++) {
    copynchars(buf, info[x],  buf.length - 1);
    strsubst(buf, " ", "");
    strsubst(buf, " ", "");
    raw_printf("[%02lu] %s",  x, buf);
  }
  return true;
}
